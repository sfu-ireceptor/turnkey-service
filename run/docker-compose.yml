# iReceptor Node Docker Orchestration

version: '2'

services:
    irdn-mongo:
        build: ./../repository-mongodb
        container_name: irdn-mongo
        expose:
        	# By default, MongoDb is not visible 
        	# outside of the default 'bridge' network
        	# One would rather need to set up a
        	# 'ports' forward port mapping to do that
            - "27017"
        image: ireceptor/repository-mongo
        volumes:
            # It is assumed here that the directory 
            # /opt/ireceptor/mongodb already exists
            - /opt/ireceptor/mongodb:/data/db
        networks:
            - default
        command: mongod --auth

    irdn-api:
        build: ./../service-js-mongodb
        container_name: irdn-api
        env_file: ./../service-js-mongodb/.env
        ports:
            - "8080:8080"
        image: ireceptor/service-js-mongodb
        networks:
            - default

    irdn-notebook:
        build: ./../dataloading
        container_name: irdn-notebook
        ports:
            - "8888:8888"
        image: ireceptor/notebook
        environment:
            - NB_UID=${UID}
        volumes:
            - ./../dataloading/notebooks:/home/jovyan/work
        networks:
            - default

networks:
    default:
        driver: bridge
